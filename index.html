<!DOCTYPE html>
<html>
<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>MAHIRA TELECOM</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

<style>

body{
margin:0;
font-family:'Poppins',sans-serif;
background:#121212;
color:white;
}

.header{
text-align:center;
padding:18px;
font-weight:700;
font-size:20px;
background:linear-gradient(135deg,#ff7a18,#ff3d54);
}

#count{
font-size:14px;
margin-top:5px;
}

/* BRAND */

.brandRow{
text-align:center;
padding:15px;
}

.brandBtn{
display:inline-block;
margin:6px;
padding:8px 16px;
border-radius:20px;
background:#2a2a2a;
color:#ccc;
cursor:pointer;
font-size:14px;
}

.active{
background:#2f6fff;
color:white;
}

/* SEARCH */

.search{
padding:15px;
position:relative;
}

.search input{
width:100%;
padding:16px 60px 16px 45px;
border-radius:25px;
border:1px solid #2a2a2a;
background:#161616;
color:#ddd;
font-size:15px;
outline:none;
}

.searchIcon{
position:absolute;
left:25px;
top:50%;
transform:translateY(-50%);
font-size:18px;
opacity:0.7;
}

/* MIC */

.mic{
position:absolute;
right:25px;
top:50%;
transform:translateY(-50%);
cursor:pointer;
}

.mic svg{
width:22px;
height:22px;
fill:#cccccc;
}

.mic.active svg{
fill:#ff3b3b;
animation:pulse 1s infinite;
}

@keyframes pulse{
0%{transform:scale(1);}
50%{transform:scale(1.2);}
100%{transform:scale(1);}
}

/* CARD */

.card{
background:#1e1e1e;
margin:15px;
padding:18px;
border-radius:16px;
}

.model{
font-weight:600;
font-size:16px;
margin-bottom:10px;
}

.rowFlex{
display:flex;
justify-content:space-between;
align-items:center;
}

.leftGroup{
display:flex;
gap:10px;
align-items:center;
}

.pricebox{
background:#1f2a22;
padding:8px 14px;
border-radius:12px;
font-weight:600;
font-size:14px;
}

.box{
background:#1b2a4a;
padding:6px 12px;
border-radius:12px;
font-size:12px;
color:#8ab4ff;
font-weight:600;
}

.oled{color:#00ff7f;}
.copy{color:#4da6ff;}
.out{color:#ff3b3b;}

.whatsappMini{
width:42px;
height:42px;
background:#25D366;
border-radius:50%;
display:flex;
align-items:center;
justify-content:center;
cursor:pointer;
}

.whatsappMini img{
width:22px;
}

.loading{
text-align:center;
padding:30px;
opacity:0.6;
}

</style>
</head>

<body>

<div class="header">
ðŸ“± MAHIRA TELECOM
<div id="count">Total Models: 0</div>
</div>

<div class="brandRow" id="brands"></div>

<div class="search">

<input type="text"
id="search"
placeholder="Search model..."
onkeyup="search()">

<div class="searchIcon">ðŸ”Ž</div>

<div class="mic" onclick="startVoice()" id="micBtn">

<svg viewBox="0 0 24 24">
<path d="M12 15a3 3 0 003-3V5a3 3 0 10-6 0v7a3 3 0 003 3zM19 11a7 7 0 01-14 0h2a5 5 0 0010 0h2z"/>
</svg>

</div>

</div>

<div id="data"></div>

<script>

let masterSheet="1sj8M7tQWFXXuk0IdVu7myTrjCTp0kOcqreBk9PUlKKQ";

let all=[];
let loadingID=0;

/* LOAD BRANDS */

fetch("https://opensheet.elk.sh/"+masterSheet+"/Sheet1")
.then(r=>r.json())
.then(d=>{

let html="";

d.forEach(b=>{

if(!b.Brand||!b.SheetID) return;

html+=`<span class="brandBtn" onclick="loadBrand('${b.SheetID}',this)">${b.Brand}</span>`;

});

document.getElementById("brands").innerHTML=html;

loadBrand(d[0].SheetID,document.querySelector(".brandBtn"));

});

/* LOAD DATA (EXTREME LITE SPEED) */

function loadBrand(sheetID,btn){

loadingID++;

let currentLoad=loadingID;

document.querySelectorAll(".brandBtn").forEach(b=>b.classList.remove("active"));

btn.classList.add("active");

document.getElementById("data").innerHTML='<div class="loading">Loading...</div>';

document.getElementById("count").innerText="Loading...";

let ids=sheetID.split(",").map(x=>x.trim());

Promise.all(ids.map(id =>
fetch("https://opensheet.elk.sh/"+id+"/Sheet1")
.then(r=>r.json())
)).then(results=>{

if(currentLoad!==loadingID) return;

let combined=[];

results.forEach(d=>{
combined=combined.concat(
d.filter(x=>x["Model"] && x["Model"]!="Model")
);
});

all=combined;

show(all);

document.getElementById("count").innerText="Total Models: "+all.length;

});

}

/* FORMAT PRICE */

function formatPrice(p){

if(!p) return "ASK";

let t=p.toUpperCase();

t=t.replace(/OLED/g,'<span class="oled">OLED</span>');
t=t.replace(/COPY/g,'<span class="copy">COPY</span>');
t=t.replace(/STOCK OUT/g,'<span class="out">STOCK OUT</span>');
t=t.replace(/\n/g,"<br>");

return t;

}

/* BOX AUTO DETECT */

function getBox(x){

for(let key in x){

if(key.toLowerCase().includes("box")){
return x[key];
}

}

return "";

}

/* SHOW */

function show(d){

let html="";

d.forEach((x,index)=>{

let model=x["Model"]||"";
let price=x["Price"]||"";
let box=getBox(x);

html+=`

<div class="card">

<div class="model">${model}</div>

<div class="rowFlex">

<div class="leftGroup">

<div class="pricebox">${formatPrice(price)}</div>

${box ? `<span class="box">${box}</span>` : ""}

</div>

<div class="whatsappMini" data-index="${index}">
<img src="https://cdn-icons-png.flaticon.com/512/733/733585.png">
</div>

</div>

</div>

`;

});

document.getElementById("data").innerHTML=html;

/* CLICK SAFE */

document.querySelectorAll(".whatsappMini").forEach(btn=>{

btn.onclick=function(){

let i=this.getAttribute("data-index");

let item=d[i];

sendWhatsApp(item["Model"],item["Price"],getBox(item));

}

});

}

/* SEARCH */

function search(){

let s=document.getElementById("search").value.toLowerCase();

let f=all.filter(x=>
(x["Model"]+"").toLowerCase().includes(s)
);

show(f);

}

/* VOICE SEARCH */

function startVoice(){

let mic=document.getElementById("micBtn");

mic.classList.add("active");

let recognition=new webkitSpeechRecognition();

recognition.lang="en-US";

recognition.onresult=function(e){

document.getElementById("search").value=e.results[0][0].transcript;

search();

};

recognition.onend=function(){

mic.classList.remove("active");

};

recognition.start();

}

</script>

</body>
</html>
